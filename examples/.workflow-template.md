# n8n Workflow Template Guide

This document defines the standard structure and conventions for all example workflows in this directory.

## Workflow JSON Structure

All workflows follow this standard n8n JSON format:

```json
{
  "name": "Workflow Name",
  "nodes": [...],
  "connections": {...},
  "pinData": {}
}
```

## Node Structure

Each node must include:
- `parameters`: Configuration object (operation-specific)
- `id`: Unique UUID (generated via crypto.randomUUID() or similar)
- `name`: Human-readable display name
- `type`: Node type identifier (e.g., "n8n-nodes-base.schedule")
- `typeVersion`: Node version (typically 1)
- `position`: [x, y] coordinates on canvas

Example:
```json
{
  "parameters": {
    "rule": {
      "interval": [{"field": "hours", "hoursInterval": 24}]
    }
  },
  "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
  "name": "Daily Schedule",
  "type": "n8n-nodes-base.schedule",
  "typeVersion": 1,
  "position": [200, 300]
}
```

## Standard Node Positioning Grid

Use consistent spacing for visual clarity:

- **Start X position**: 200-400 (triggers)
- **Horizontal spacing**: 220-300 pixels between nodes
- **Vertical base**: 300 (main flow)
- **Branch spacing**: 200 pixels vertical offset for IF branches

### Example Layout
```
Trigger (240, 300) → Node1 (460, 300) → IF (680, 300)
                                           ├─ True (900, 200)
                                           └─ False (900, 400)
```

## Common Node Types Reference

### Triggers
- **Schedule**: `n8n-nodes-base.schedule`
- **Webhook**: `n8n-nodes-base.webhook`
- **Manual**: `n8n-nodes-base.manualTrigger`

### Pterodactyl Operations
- **Type**: `n8n-nodes-pterodactyl.pterodactyl`
- **Operations**: server, backup, database, file, etc.

### Utility Nodes
- **IF**: `n8n-nodes-base.if` (conditional branching)
- **Set**: `n8n-nodes-base.set` (data transformation)
- **Wait**: `n8n-nodes-base.wait` (delays)
- **Split In Batches**: `n8n-nodes-base.splitInBatches` (looping)
- **HTTP Request**: `n8n-nodes-base.httpRequest` (external calls)

## Connection Structure

Connections define data flow between nodes:

```json
"connections": {
  "Source Node Name": {
    "main": [
      [
        {
          "node": "Target Node Name",
          "type": "main",
          "index": 0
        }
      ]
    ]
  }
}
```

### Branching (IF nodes)
```json
"IF Node": {
  "main": [
    [{"node": "True Path", "type": "main", "index": 0}],  // True branch
    [{"node": "False Path", "type": "main", "index": 0}]  // False branch
  ]
}
```

### Loops (Split In Batches)
```json
"Loop Node": {
  "main": [
    [{"node": "Next Node", "type": "main", "index": 0}],  // Continue loop
    []  // Loop complete (empty array)
  ]
},
"Processing Node": {
  "main": [
    [{"node": "Loop Node", "type": "main", "index": 0}]  // Back to loop
  ]
}
```

## Naming Conventions

### Node Names
- Use descriptive, action-oriented names
- Examples: "List All Servers", "Create Backup", "Check If Successful"
- Avoid generic names like "Pterodactyl1", "IF1"

### Workflow Names
- Format: "Purpose - Context"
- Examples: "Automated Server Backup", "Resource Monitoring - Production"

## README Template Structure

Each workflow directory should contain a README.md with these sections:

```markdown
# [Workflow Name]

## Overview
Brief 2-3 sentence description of what this workflow does and why it's useful.

## Prerequisites
- n8n instance (self-hosted or cloud)
- Pterodactyl Panel with API access
- Pterodactyl credentials configured in n8n
- [Any additional requirements]

## Setup Instructions

### 1. Import Workflow
1. Copy the contents of `workflow.json`
2. In n8n, go to Workflows → Import from File/URL
3. Paste the JSON content

### 2. Configure Credentials
1. Open any Pterodactyl node in the workflow
2. Select or create Pterodactyl credentials
3. Test the connection

### 3. Customize Parameters
- **Server ID**: Update to match your server
- **[Other parameters]**: Adjust as needed

### 4. Test & Activate
1. Execute the workflow manually to test
2. Verify the expected behavior
3. Activate the workflow for automated execution

## Usage
Describe how to run and monitor the workflow.

## Customization Guide

### Adjust Schedule
How to modify trigger timing.

### Modify Parameters
Key parameters users might want to change.

## Expected Behavior
What the workflow should produce when successful.

## Troubleshooting

### Common Issues
1. **"Server not found" error**
   - Solution: Verify server ID is correct

2. **"Permission denied" error**
   - Solution: Check API key has required permissions

## Related Workflows
Links to similar or complementary examples.
```

## Credential Handling

**NEVER** include actual credentials in workflow JSON. Use placeholder references:

```json
"credentials": {
  "pterodactylApi": {
    "id": "1",
    "name": "Pterodactyl Account"
  }
}
```

Users will connect their own credentials after import.

## Testing Checklist

Before finalizing any workflow:
- [ ] JSON syntax is valid
- [ ] All node IDs are unique UUIDs
- [ ] Node positions follow grid layout
- [ ] Connections are properly defined
- [ ] Workflow imports successfully in n8n
- [ ] Nodes render correctly on canvas
- [ ] No hardcoded credentials
- [ ] README is complete and accurate
